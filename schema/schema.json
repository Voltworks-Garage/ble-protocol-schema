{
  "protocol": {
    "name": "ble_telemetry",
    "version": "1.0.0"
  },
  "frame": {
    "byte_order": "little",
    "checksum": {
      "algorithm": "sum_mod256",
      "scope": "entire_payload",
      "description": "Single checksum at end of final frame covering entire reassembled payload"
    },
    "first": {
      "fields": [
        {"name": "sync", "type": "uint8", "value": "0xAA"},
        {"name": "length", "type": "uint8", "description": "total payload length across all frames"},
        {"name": "msg_id", "type": "uint8"},
        {"name": "payload", "type": "variable", "description": "partial payload data"}
      ]
    },
    "continuation": {
      "fields": [
        {"name": "payload", "type": "variable", "description": "continuation of payload data"}
      ]
    },
    "final": {
      "description": "Last frame (may be first or continuation)",
      "fields": [
        {"name": "checksum", "type": "uint8", "description": "checksum of entire reassembled payload"}
      ]
    }
  },
  "messages": {
    "server": {
      "heartbeat": {
        "id": "0x01",
        "maxAge": 5000,
        "fields": {
          "uptime_ms": "uint32",
          "battery_mv": "uint16",
          "status_flags": "uint8"
        }
      },
      "server_message": {
        "id": "0x04",
        "maxAge": 1000,
        "fields": {
          "data": {"type": "string", "max_length": 128}
        }
      },
      "sensor_data": {
        "id": "0x02",
        "maxAge": 2000,
        "fields": {
          "timestamp_ms": "uint32",
          "temperature_c": "int16",
          "humidity_pct": "uint8",
          "pressure_pa": "uint32"
        }
      },
      "motor_status": {
        "id": "0x03",
        "maxAge": 1000,
        "fields": {
          "rpm": "uint16",
          "current_ma": "uint16",
          "temp_c": "int8",
          "fault_code": "uint8"
        }
      },
      "config_ack": {
        "id": "0x11",
        "maxAge": 1000,
        "fields": {
          "param_id": "uint8",
          "result": "uint8"
        }
      }
    },
    "client": {
      "config_set": {
        "id": "0x10",
        "maxAge": 1000,
        "fields": {
          "param_id": "uint8",
          "value": "uint32"
        }
      }
    }
  },
  "types": {
    "uint8": {"size": 1, "signed": false},
    "int8": {"size": 1, "signed": true},
    "uint16": {"size": 2, "signed": false},
    "int16": {"size": 2, "signed": true},
    "uint32": {"size": 4, "signed": false},
    "int32": {"size": 4, "signed": true},
    "uint64": {"size": 8, "signed": false},
    "int64": {"size": 8, "signed": true},
    "string": {"size": "variable", "signed": false}
  }
}